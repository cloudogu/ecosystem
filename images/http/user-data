#cloud-config
autoinstall:
  apt:
    geoip: true
    preserve_sources_list: false
    primary:
    - arches: [amd64, i386]
      uri: http://de.archive.ubuntu.com/ubuntu
    - arches: [default]
      uri: http://ports.ubuntu.com/ubuntu-ports
  identity: {hostname: ces-2021-03-04, password: $6$eXtrTEXrpV8WK64H$pvrncLTd2VyZ8sOk8hHc1PGl1ACmtv9Bu7Fsv69m0hu8ELYNipZcjwd9dfZzwMdlYuUYgiiA/rXYK.2v6Wi.X0,
    realname: ces-admin, username: ces-admin}
  keyboard: {layout: us, toggle: null, variant: ''}
  locale: en_US
  network:
    ethernets:
      enp0s3: {dhcp4: true}
    version: 2
  ssh:
    allow-pw: true
    authorized-keys: []
    install-server: true
  storage:
    version: 1
    config:
      - id: sda
        type: disk
        ptable: gpt
        path: /dev/sda
        wipe: superblock
        grub_device: true

      - id: sda1-bios
        device: sda
        type: partition
        number: 1
        size: 1MB
        flag: bios_grub
      - id: sda2-boot
        device: sda
        type: partition
        number: 2
        size: 1GB
        flag: boot
      - id: sda3-swap
        device: sda
        type: partition
        number: 3
        size: 8G
        flag: swap
      - id: sda4-root
        device: sda
        type: partition
        number: 4
        size: -1

      - id: sda2-boot-ext4
        type: format
        volume: sda2-boot
        fstype: ext4
      - id: sda3-swap-swap
        type: format
        volume: sda3-swap
        fstype: swap
      - id: sda4-root-btrfs
        type: format
        volume: sda4-root
        fstype: btrfs

      - id: mount-sda4-root
        type: mount
        path: /
        device: sda4-root-btrfs
      - id: mount-sda2-boot
        type: mount
        path: /boot
        device: sda2-boot-ext4
      - id: mount-sda3-swap
        type: mount
        path: /swap.img
        device: sda3-swap-swap
  version: 1